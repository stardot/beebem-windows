<html>
<head>
  <title>BeebEm - BBC Micro and Master 128 Emulator</title>

  <meta http-equiv="Content-Type" content="text/html;charset=us-ascii" />
</head>

<body lang="en-GB" bgcolor="#FFFFC0" dir="ltr">

  <table width="100%" border="0" cellpadding="2" cellspacing="2">
    <tr>
      <td width="100">
        <p align="center"><img src="beeb.gif" name="BeebEm" alt="BBC Micro" 
                               align="middle" width="48" height="48" border="0" /></p>
      </td>

      <td>
        <h1 align="center">BeebEm - BBC Micro and Master 128 Emulator</h1>
      </td>

      <td width="100">
        <p align="center"><img src="beeb.gif" name="BeebEm" alt="BBC Micro"
                               align="middle" width="48" height="48" border="0" /></p>
      </td>
    </tr>
  </table>

  <table width="100%" border="0" cellpadding="2" cellspacing="2">
    <tr>
      <td width="10%"></td>

      <td width="20%">
        <p align="center"><a href="index.html">Home</a></p>
      </td>

      <td width="20%">
        <p align="center"><a href="contents.html">Help Contents</a></p>
      </td>

      <td width="20%">
        <p align="center"><a href="http://www.mkw.me.uk/beebem/software.html">Download Software</a></p>
      </td>

      <td width="20%">
        <p align="center"><a href="http://www.mkw.me.uk/beebem/index.html">BeebEm Website</a></p>
      </td>

      <td width="10%"></td>
    </tr>
  </table>

  <hr size="1" color="#004080" />

  <table width="100%" border="0" cellpadding="5" cellspacing="0">
    <tr>
      <td width="10%"></td>

      <td width="80%">
          <!-- Start of content -->

          <h1 align="center">Real-Time Clock</a></h1>

          <p>
              The RTC is found in the Master 128 and FileStore machines and is based on a HD146818 chip. This provides a Real Time Clock and 50 bytes of user RAM (CMOS).
              The clock however keeps the year in a single byte ranging from 00-99, and wraps round at the start of each century. The MOS 3.20 and MOS 3.50 do not display
              the year correctly after 2000, as they simply add "19" in front of the year from the RTC chip. There are patches for the MOS available or add on ROMs to combat this.

              The facility is provided to subtract a given amount. When the 'RTC Y2K Adjust' option is enabled (on the Options menu and/or preferences file) BeebEm will subtact years from the current time
              specified in the parameter 'RTCY2KOffset' in the preferences file. This value is in hexadecimal. Therefore RTCY2KOffset=14 will subtract 20 from the current year when RTC Y2K Adjust is enabled.

              The RTC alarm function that triggers hardware interrupts is not implemented as it wasn't on the Master 128. Hardware interrupts are implemented for the clock updates for the FileStore as it
              depends on these for various internal timekeeping.

              On the Master 128 the BASIC TIME$ variable can be
              used to read and update the clock.  When BeebEm starts a machine it sets the clock to
              the current time from the PC's clock.
          </p>

          <p>Some examples of reading and setting the clock:</p>

<pre>
  PRINT TIME$
  TIME$="Mon,22 Jan 1996"
  TIME$="23:10:42"
  TIME$="Mon,22 Jan 1996.23:10:42"
</pre>

<p>
    Note: There is also a UserPort RTC implemented in BeebEm. This is the dongle supplied with the Econet Level3 FileServer, and shouldn't be confused with the RTC on the Master 128 or FileStore.
    Similarly, it can be enabled on the menu using the 'UserPort RTC' option, or in the preferences file. Various versions of the L3 FileServer software treat the year differently, and for this reason 
    it is possible to provide the offset +/- in the preferences file using the parameter 'UserPort RTCOffset'. The value in hexadecimal and is a signed char and has a range of -127-127. 0xFF is thus -1 and 0x13 is +19. 

</p>

          <!-- End of content -->
      </td>

      <td width="10%"></td>
    </tr>
  </table>

  <hr size="1" color="#004080" />
  <p>Copyright &copy; 2020 Mike Wyatt</a></p>
  <hr size="1" color="#004080" />
</body>
</html>
