<!DOCTYPE html>
<html lang="en">
  <head>
    <title>BeebEm - BBC Micro and Master 128 Emulator</title>
    <meta http-equiv="Content-Type" content="text/html;charset=us-ascii">
    <link rel="stylesheet" href="style.css">
  </head>

  <body>
    <header>
      <div class="title">
        <div class="logo">
          <img src="beeb.gif" alt="BBC Micro" width="48" height="48">
        </div>
        <h1>
          BeebEm - BBC Micro and Master 128 Emulator
        </h1>
        <div class="logo">
          <img src="beeb.gif" alt="BBC Micro" width="48" height="48">
        </div>
      </div>

      <nav>
        <div>
          <a href="index.html">Home</a>
        </div>
        <div>
          <a href="contents.html">Help Contents</a>
        </div>
        <div>
          <a href="http://www.mkw.me.uk/beebem/software.html">Download Software</a>
        </div>
          <div>
          <a href="http://www.mkw.me.uk/beebem/index.html">BeebEm Website</a>
        </div>
      </nav>
    </header>

    <main>
      <h1>Disc Images</h1>

      <p>
        BeebEm emulates two double sided floppy disc drives, know as drive 0
        (second side 2) and drive 1 (second side 3). You can load a disc image
        file into either drive 0 or 1 using the <span class="ui">File</span>
        menu in BeebEm.
      </p>

      <p>
        Once a disc image is loaded you can use the BASIC interpreter and BBC
        operating system to access the files in the disc. Some useful disc
        commands are:
      </p>

      <table>
        <tr>
          <th>Command</th>
          <th>Description</th>
        </tr>

        <tr>
          <td><span class="cmd">*CAT</span></td>
          <td>List files on the disc</td>
        </tr>

        <tr>
          <td><span class="cmd">*DRIVE &lt;drive&gt;</span></td>
          <td>Change default drive number (0, 1, 2 or 3)</td>
        </tr>

        <tr>
          <td><span class="cmd">LOAD "&lt;file&gt;"</span></td>
          <td>Load a BASIC program</td>
        </tr>

        <tr>
          <td><span class="cmd">CHAIN "&lt;file&gt;"</span></td>
          <td>Load and run a BASIC program</td>
        </tr>

        <tr>
          <td><span class="cmd">SAVE "&lt;file&gt;"</span></td>
          <td>Save a BASIC program</td>
        </tr>

        <tr>
          <td><span class="cmd">*DELETE &lt;file&gt;</span></td>
          <td>Delete a file</td>
        </tr>

        <tr>
          <td><span class="cmd">*RUN &lt;file&gt;</span></td>
          <td>Load and run a binary program</td>
        </tr>

        <tr>
          <td><span class="cmd">*TITLE &lt;title&gt;</span></td>
          <td>Put a title on the disc</td>
        </tr>

        <tr>
          <td><span class="cmd">*BUILD &lt;file&gt;</span></td>
          <td>
            Create a file on the disc containing a set of commands
            you type in. Press <kbd>Escape</kbd> to end
          </td>
        </tr>

        <tr>
          <td><span class="cmd">*EXEC &lt;file&gt;</span></td>
          <td>
            Execute the commands contained in a file (created with
            <span class="cmd">*BUILD</span> for example)
          </td>
        </tr>
      </table>

      <h2>Booting Discs</h2>

      <p>
        Many disc images that can be downloaded from the Internet have been set
        up to be "bootable" (i.e., configured to run a particular program). To
        boot a disc press <kbd>Shift</kbd> + <kbd>F12</kbd> (i.e., hold the
        <kbd>Shift</kbd> key down and press <kbd>F12</kbd>). If a disc does not
        boot it is probably because it has not been set up to be bootable.
        Non-bootable disc can be accessed using the commands shown above.
      </p>

      <p>
        If you want to make a disc bootable you will need to create a file
        called !BOOT containing the commands to execute when the disc is booted.
        The <span class="cmd">*BUILD</span> command can be used to create the
        !BOOT file. The disc image file also needs to be configured to run the
        !BOOT file when its booted. This can be done by running the command
        <span class="cmd">*OPT4,3</span>.
      </p>

      <p>
        If you want to write data to a disc image (e.g., save a game position)
        you will need to make sure that <span class="ui">Write Protect</span> is
        switched off on the <span class="ui">File &rarr; Disc Options</span>
        menu for the drive you are using. Disc writes will then write data
        straight back to the image file on your PC disc.
      </p>

      <p>
        You can find out more information about using discs by reading the DFS
        (Disc Filing System) guides available on the Internet.
       </p>

      <h2>Modifying Disc Image Files</h2>

      <p>
        The BeebEm <span class="ui">File menu</span> provides options to create
        new disc image files. The <span class="ui">Edit</span> menu provides
        options to export and import files from/to a disc image file.
      </p>

      <figure>
        <img src="export.png" alt="BeebEm Disc Export dialog box" width="400" height="515">
      </figure>

      <p>
        When importing and exporting files BeebEm will look for or create an
        additional file with a <span class="file">.inf</span> extension to
        accompany the data file. The <span class="file">.inf</span> file
        contains load address, execution address and file length information for
        the data file. The format of the data in the <span
        class="file">.inf</span> file is:
      </p>

      <blockquote>
        <b>&lt;file name&gt; &lt;load address&gt;
        &lt;execution address&gt; &lt;file length&gt;</b>
      </blockquote>

      <p>
        The file name must include the DFS directory prefix for the file and it
        must be 9 characters long. The addresses and length are 6 digit hex
        numbers, e.g.:
      </p>

      <pre>
        A.DARE    004000 006691 002700
        $.CHUCKIE 001100 0029AB 002700
      </pre>

      <h2>ADFS Discs</h2>

      <p>
        If you want to use ADFS discs in the Master 128 mode then load an ADFS
        disk image (such as the <span class="file">MasterWelcome.adl</span>
        image in the <span class="file">DiscIms</span> folder) and type <span
        class="cmd">*ADFS</span> to mount it. You can also press
        <kbd>A</kbd> + <kbd>F12</kbd> to mount an ADFS disc.
      </p>

      <p>
        ADFS is also supported in Model B and B Plus modes. Note that in Model B
        mode you will need to select the Acorn 1770 disc controller and add
        <span class="file">ADFS-1.30.rom</span> to the ROM configuration.
      </p>

      <h2>FSD Disc Images</h2>

      <p>
        BeebEm supports loading FSD format disc images, which can be used for
        titles that use disc copy protection techniques. BeebEm does not allow
        you to write to FSD format discs, so these files are always opened
        read-only. There is more information about the FSD format in
        <span class="file">Documents\FSDFileFormat.txt</span>. Note that FSD
        files only work with the 8271 disc controller, so cannot be used with
        BeebEm's Master 128 emulation.
      </p>

      <h2 id="corrupt">Corrupted Disc Images</h2>

      <p>
        Some of the disc images you will find on the Internet or that you create
        yourself will have an invalid catalogue (they contain just enough
        information for disc reads to work but not writes).
      </p>

      <p>
        When you write enable a disc BeebEm checks the disc catalogues and it
        will display a warning message if either are invalid. If you get a
        warning message then do NOT write to the disc image, as it is possible
        you will lose data.
      </p>

      <p>
        To fix an invalid catalogue do the following:
      </p>

      <ol>
        <li>Start BeebEm and load the invalid image into drive 1.</li>

        <li>Create a new disc image file in drive 0.</li>

        <li>
          If the invalid image uses a Watford DFS 62 file catalogue then format
          the new disc image with a 62 file catalogue (you need the Watford DFS
          ROM installed), type:
          <pre>
            *ENABLE
            *FORM80 0
          </pre>
        </li>

        <li>
          Copy all the files from the invalid disc to the new one and set the
          shift break option and title, type:
          <pre>
            *COPY 1 0 *.*
            *OPT4,3
            *TITLE &lt;title&gt;
          </pre>
        </li>
      </ol>

      <p>
        The new image will now have a valid catalogue. If you are using double
        sided images then remember to format and copy both sides (the second
        sides of disc 0 and 1 are 2 and 3).
      </p>
    </main>

    <footer>
      <p>Copyright &copy; 2020 Mike Wyatt</p>
     </footer>
  </body>
</html>
